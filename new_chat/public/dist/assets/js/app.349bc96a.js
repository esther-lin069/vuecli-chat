(function(e){function t(t){for(var r,o,l=t[0],i=t[1],c=t[2],d=0,p=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,l=1;l<n.length;l++){var i=n[l];0!==a[i]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},s=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/chat/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=i;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0e75":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("chat-log"),n("Member")],1)},o=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"chat"}},[n("div",{attrs:{id:"log"}}),n("div",{attrs:{id:"form"}},[n("form",{staticClass:"us-form form-inline",on:{submit:function(t){return t.preventDefault(),e.sendMsg(t)}}},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{id:"msg-type"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.type=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"N",selected:""}},[e._v("一般")]),n("option",{attrs:{value:"A"}},[e._v("廣播")])]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],staticClass:"w3-input w3-border w3-round",attrs:{type:"text",id:"msg",autofocus:""},domProps:{value:e.msg},on:{input:function(t){t.target.composing||(e.msg=t.target.value)}}}),n("button",{attrs:{type:"submit"}},[e._v("Send")])])])])},i=[],c=(n("caad"),n("b64b"),n("ac1f"),n("2532"),n("5319"),n("841c"),n("1276"),n("b85c")),u=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),"http://localhost:8080"),d="http://localhost:8080",p=[],f=[],m=[],v="",b="test",h="123",O="false",g=new URL(location.href);b="main",h=g.searchParams.get("user"),O=g.searchParams.get("private");var y,_,N={API:u,HOST:d,ROOMS:p,MEMBERS:f,ONLINE:m,RECIPIENT:v,CHATROOM:b,USER:h,PRIVATION:O,CONN:r},w=N,x=n("2877"),C=Object(x["a"])(w,y,_,!1,null,null,null),M=C.exports;function S(e){var t=/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|#|-)+)/g;return e=e.replace(t,"<a href='$1$2' target=\"_blank\">$1$2</a>").replace(/\n/g,"<br />"),e}window.onload=function(){var e=document.getElementById("log");if(window["WebSocket"])M.CONN=new WebSocket("ws://"+window.location.host+"/ws/"+M.CHATROOM+location.search),M.CONN.onclose=function(){var e=document.createElement("div");e.innerHTML="<b>Connection closed.</b>",r(e)},M.CONN.onmessage=function(e){for(var t=e.data.split("\n"),r=0;r<t.length;r++)n(t[r])};else{var t=document.createElement("div");t.innerHTML="<b>Your browser does not support WebSockets.</b>",r(t)}function n(e){var t=document.createElement("div"),n=JSON.parse(e),a=new Date(n.time).toLocaleString("zh-TW");if("SYS"===n.sender){if("H"===n.type){var s=JSON.parse(n.content);M.ONLINE=[],M.CHATROOM!==s.room_info&&alert("聊天室位置出錯!"+M.CHATROOM+s.room_info);for(var o=s.user_info.split(","),l=0;l<o.length;l++)if(o[l]!==M.USER){var i={username:o[l]};M.ONLINE.push(i)}}else{s=JSON.parse(n.content);var u,d=JSON.parse(s.room_info),p=s.user_info.split(","),f=Object(c["a"])(M.MEMBERS);try{for(f.s();!(u=f.n()).done;){var m=u.value;p.includes(m.username)?m.online=!0:m.online=!1}}catch(g){f.e(g)}finally{f.f()}var v,b=Object.keys(d),h=Object(c["a"])(M.ROOMS);try{for(h.s();!(v=h.n()).done;)M.ROOM=v.value,b.includes(M.ROOM.room_id)&&(M.ROOM.len=d[M.ROOM.room_id])}catch(g){h.e(g)}finally{h.f()}}t.innerHTML='<div class="system-text"><label>'+s.text+"</label></div>"}else{var O=S(n.content);if("A"===n.type){if("true"===M.PRIVATION)return;t.innerHTML='<div class="chat-text">                  <label class="sm-text"><span class="b-text">'+n.sender+"</span> - "+a+' 廣播</lable><br>                  <label class="bro-text">'+O+"</label>              </div>"}else t.innerHTML='<div class="chat-text">                  <label class="sm-text"><span class="b-text">'+n.sender+"</span> -"+a+'</lable><br>                  <label class="md-text">'+O+"</label>              </div>"}r(t)}function r(t){var n=e.scrollTop>e.scrollHeight-e.clientHeight-1;e.appendChild(t),n&&(e.scrollTop=e.scrollHeight-e.clientHeight)}};var E={name:"ChatLog",data:function(){return{msg:"",type:"N"}},methods:{sendMsg:function(){var e=this.msg.replaceAll("'","&#39;");if(!M.CONN)return!1;if(""===this.msg)return!1;"true"===M.PRIVATION&&(this.type="P");var t=JSON.stringify({sender:M.USER,roomId:M.CHATROOM,recipient:M.RECIPIENT,type:this.type,content:e,time:Date.now()});M.CONN.send(t),this.msg=""}}},R=E,T=Object(x["a"])(R,l,i,!1,null,null,null),I=T.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"member"}},[n("h5",{staticClass:"title-text"},[n("button",{staticClass:"list-btn",style:{color:e.seen?"#FFF":"#000"},on:{click:function(t){e.seen=!e.seen}}},[e._v(" 在線列表 ")])]),n("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[e.seen?n("div",{key:"online"},[n("div",{staticClass:"card",attrs:{id:"myUserBlock"}},[n("div",{staticClass:"div-ell"},[n("span",{staticStyle:{color:"#f4e868","margin-right":"8px"}},[n("i",{staticClass:"fa fa-user"})]),n("span",{staticClass:"box-text"},[e._v(e._s(e.username))])])]),n("dl",e._l(e.o_members,(function(t,r){return n("dt",{key:r,attrs:{id:t.username}},[n("div",{staticClass:"card"},[n("div",{staticClass:"div-ell"},[n("span",{staticStyle:{color:"#00798f","margin-right":"8px"}},[n("i",{staticClass:"fa fa-user"})]),n("span",{staticClass:"box-text"},[e._v(e._s(t.username))])])])])})),0)]):e._e()])],1)])},j=[],H={name:"Member",data:function(){return{username:M.USER,o_members:[],seen:!0,search:""}},methods:{},beforeUpdate:function(){this.o_members=M.ONLINE}},A=H,L=Object(x["a"])(A,P,j,!1,null,null,null),k=L.exports,$={name:"Chat",components:{ChatLog:I,Member:k}},J=$,U=(n("74b7"),Object(x["a"])(J,s,o,!1,null,null,null)),B=U.exports,W=n("bc3a"),D=n.n(W),F=n("2106"),V=n.n(F),Y=n("5886"),z=n("d0be"),q=n.n(z);n("4413");a["a"].use(Y["default"]),a["a"].use(q.a),a["a"].use(V.a,D.a),a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(B)}}).$mount("#app")},"74b7":function(e,t,n){"use strict";n("0e75")}});
//# sourceMappingURL=app.349bc96a.js.map