{"remainingRequest":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/thread-loader/dist/cjs.js!/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/babel-loader/lib/index.js!/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/src/components/chat_componenet/ChatLog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/src/components/chat_componenet/ChatLog.vue","mtime":1606213248189},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9BcHBsaWNhdGlvbnMvTUFNUC9odGRvY3MvZXN0aGVyX2xpbi93b3JrMDYvY2xpL25ld19jaGF0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGdsb2JhbCBmcm9tICcuLi9nbG92YWxfdmFyJzsKLyogd3MgKi8KCndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2cnKTsgLy8gV1PpgKPnt5rvvJrmjqXmlLblu6Pmkq3oqIrmga8KCiAgaWYgKHdpbmRvd1snV2ViU29ja2V0J10pIHsKICAgIGdsb2JhbC5DT05OID0gbmV3IFdlYlNvY2tldCgnd3M6Ly8nICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyAiL3dzIiArIGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoKTsKCiAgICBnbG9iYWwuQ09OTi5vbmNsb3NlID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICBpdGVtLmlubmVySFRNTCA9ICc8Yj5Db25uZWN0aW9uIGNsb3NlZC48L2I+JzsKICAgICAgYXBwZW5kTG9nKGl0ZW0pOwogICAgfTsKCiAgICBnbG9iYWwuQ09OTi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgIHZhciBtZXNzYWdlcyA9IGV2dC5kYXRhLnNwbGl0KCdcbicpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykgewogICAgICAgIEhhbmRsZU1lc3NhZ2UobWVzc2FnZXNbaV0pOwogICAgICB9CiAgICB9OwogIH0gZWxzZSB7CiAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgaXRlbS5pbm5lckhUTUwgPSAnPGI+WW91ciBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgV2ViU29ja2V0cy48L2I+JzsKICAgIGFwcGVuZExvZyhpdGVtKTsKICB9IC8vIOiZleeQhuioiuaBrwoKCiAgZnVuY3Rpb24gSGFuZGxlTWVzc2FnZShtZXNzYWdlKSB7CiAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgdmFyIGNoYXQgPSBKU09OLnBhcnNlKG1lc3NhZ2UpOwogICAgdmFyIGNoYXRUaW1lID0gbmV3IERhdGUoY2hhdC50aW1lKS50b0xvY2FsZVN0cmluZygnemgtVFcnKTsgLy8g5Yik5pa35piv5ZCm54K657O757Wx6KiK5oGvCgogICAgaWYgKGNoYXQuc2VuZGVyID09PSAnU1lTJykgewogICAgICAvLyDns7vntbFoaW50IOS9v+eUqOiAheWQjeWWrgogICAgICBpZiAoY2hhdC50eXBlID09PSAnSCcpIHsKICAgICAgICB2YXIgaW5mbyA9IEpTT04ucGFyc2UoY2hhdC5jb250ZW50KTsKICAgICAgICBnbG9iYWwuT05MSU5FID0gW107IC8vIOa4heepuuWOn+S+hueahOWcqOe3muS6uuWToeWIl+ihqAoKICAgICAgICBpZiAoZ2xvYmFsLkNIQVRST09NICE9PSBpbmZvLnJvb21faW5mbykgewogICAgICAgICAgYWxlcnQoJ+iBiuWkqeWupOS9jee9ruWHuumMryEnICsgZ2xvYmFsLkNIQVRST09NICsgaW5mby5yb29tX2luZm8pOwogICAgICAgIH0gLy8g5Zyo57ea5YiX6KGoCgoKICAgICAgICB2YXIgbWVtYmVycyA9IGluZm8udXNlcl9pbmZvLnNwbGl0KCcsJyk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWVtYmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKG1lbWJlcnNbaV0gPT09IGdsb2JhbC5VU0VSKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0bXAgPSB7CiAgICAgICAgICAgICd1c2VybmFtZSc6IG1lbWJlcnNbaV0KICAgICAgICAgIH07CiAgICAgICAgICBnbG9iYWwuT05MSU5FLnB1c2godG1wKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW5mbyA9IEpTT04ucGFyc2UoY2hhdC5jb250ZW50KTsKICAgICAgICB2YXIgcm9vbXMgPSBKU09OLnBhcnNlKGluZm8ucm9vbV9pbmZvKTsgLy8g6IGK5aSp5a6k5ZCN5Zau5bCN5oeJ5Lq65pW4CgogICAgICAgIHZhciB1c2VycyA9IGluZm8udXNlcl9pbmZvLnNwbGl0KCcsJyk7IC8vIOiBiuWkqeWupOaJgOacieWcqOe3muS6uuWToQoKICAgICAgICAvKiDkuIrnt5rni4DmhYvorormm7QgKi8KCiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGdsb2JhbC5NRU1CRVJTKSwKICAgICAgICAgICAgX3N0ZXA7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgbWVtYmVyID0gX3N0ZXAudmFsdWU7CgogICAgICAgICAgICBpZiAodXNlcnMuaW5jbHVkZXMobWVtYmVyLnVzZXJuYW1lKSkgewogICAgICAgICAgICAgIG1lbWJlci5vbmxpbmUgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1lbWJlci5vbmxpbmUgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLyog6IGK5aSp5a6k5Lq65pW46K6K5pu0ICovCgogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CgogICAgICAgIHZhciByb29tbGlzdF9zdGF0ZXMgPSBPYmplY3Qua2V5cyhyb29tcyk7CgogICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZ2xvYmFsLlJPT01TKSwKICAgICAgICAgICAgX3N0ZXAyOwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgZ2xvYmFsLlJPT00gPSBfc3RlcDIudmFsdWU7CgogICAgICAgICAgICBpZiAocm9vbWxpc3Rfc3RhdGVzLmluY2x1ZGVzKGdsb2JhbC5ST09NLnJvb21faWQpKSB7CiAgICAgICAgICAgICAgZ2xvYmFsLlJPT00ubGVuID0gcm9vbXNbZ2xvYmFsLlJPT00ucm9vbV9pZF07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICB9CiAgICAgIH0gLy8g57O757Wx6KiK5oGvZXgu77y477y477y46Zui6ZaL6IGK5aSp5a6kCgoKICAgICAgaXRlbS5pbm5lckhUTUwgPSAiPGRpdiBjbGFzcz1cInN5c3RlbS10ZXh0XCI+PGxhYmVsPiIgKyBpbmZvLnRleHQgKyAiPC9sYWJlbD48L2Rpdj4iOwogICAgfSBlbHNlIHsKICAgICAgLy8g5Yik5Yil5YWn5a655piv5ZCm5YyF5ZCr6Y+I57WQCiAgICAgIHZhciB0ZXh0ID0gaXNVcmwoY2hhdC5jb250ZW50KTsgLy8g5L6G6Ieq5YW25LuW55So5oi25oiW5L2/55So6ICF55qE5buj5pKt5raI5oGvCgogICAgICBpZiAoY2hhdC50eXBlID09PSAnQScpIHsKICAgICAgICAvLyDmmK/np4HoqIrnmoToqbHmiorlhajln5/lu6Pmkq3mk4vkuIvkvoYKICAgICAgICBpZiAoZ2xvYmFsLlBSSVZBVElPTiA9PT0gJ3RydWUnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpdGVtLmlubmVySFRNTCA9ICI8ZGl2IGNsYXNzPVwiY2hhdC10ZXh0XCI+ICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwic20tdGV4dFwiPjxzcGFuIGNsYXNzPVwiYi10ZXh0XCI+IiArIGNoYXQuc2VuZGVyICsgIjwvc3Bhbj4gLSAiICsgY2hhdFRpbWUgKyAiIFx1NUVFM1x1NjRBRDwvbGFibGU+PGJyPiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImJyby10ZXh0XCI+IiArIHRleHQgKyAiPC9sYWJlbD4gICAgICAgICAgICAgIDwvZGl2PiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbS5pbm5lckhUTUwgPSAiPGRpdiBjbGFzcz1cImNoYXQtdGV4dFwiPiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cInNtLXRleHRcIj48c3BhbiBjbGFzcz1cImItdGV4dFwiPiIgKyBjaGF0LnNlbmRlciArICI8L3NwYW4+IC0iICsgY2hhdFRpbWUgKyAiPC9sYWJsZT48YnI+ICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwibWQtdGV4dFwiPiIgKyB0ZXh0ICsgIjwvbGFiZWw+ICAgICAgICAgICAgICA8L2Rpdj4iOwogICAgICB9CiAgICB9IC8vIOaJk+WNsOioiuaBrwoKCiAgICBhcHBlbmRMb2coaXRlbSk7CiAgfSAvL+Wwh+iBiuWkqeioiuaBr+aUvuWFpeiBiuWkqeWNgOWhigoKCiAgZnVuY3Rpb24gYXBwZW5kTG9nKGl0ZW0pIHsKICAgIHZhciBkb1Njcm9sbCA9IGxvZy5zY3JvbGxUb3AgPiBsb2cuc2Nyb2xsSGVpZ2h0IC0gbG9nLmNsaWVudEhlaWdodCAtIDE7CiAgICBsb2cuYXBwZW5kQ2hpbGQoaXRlbSk7CgogICAgaWYgKGRvU2Nyb2xsKSB7CiAgICAgIGxvZy5zY3JvbGxUb3AgPSBsb2cuc2Nyb2xsSGVpZ2h0IC0gbG9nLmNsaWVudEhlaWdodDsKICAgIH0KICB9Cn07IC8vIOWIpOaWt+aYr+WQpueCuui2hemAo+e1kAoKCmZ1bmN0aW9uIGlzVXJsKHYpIHsKICB2YXIgcmVnID0gLyhodHRwOlwvXC98aHR0cHM6XC9cLykoKFx3fD18XD98XC58XC98JnwjfC0pKykvZzsKICB2ID0gdi5yZXBsYWNlKHJlZywgIjxhIGhyZWY9JyQxJDInIHRhcmdldD1cIl9ibGFua1wiPiQxJDI8L2E+IikucmVwbGFjZSgvXG4vZywgJzxiciAvPicpOwogIHJldHVybiB2Owp9CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NoYXRMb2cnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtc2c6ICcnLAogICAgICB0eXBlOiAnTicKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZW5kTXNnOiBmdW5jdGlvbiBzZW5kTXNnKCkgewogICAgICB2YXIgY29udGVudCA9IHRoaXMubXNnLnJlcGxhY2VBbGwoJ1wnJywgJyYjMzk7Jyk7CgogICAgICBpZiAoIWdsb2JhbC5DT05OKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAodGhpcy5tc2cgPT09ICcnKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoZ2xvYmFsLlBSSVZBVElPTiA9PT0gJ3RydWUnKSB7CiAgICAgICAgdGhpcy50eXBlID0gJ1AnOwogICAgICB9CgogICAgICB2YXIganN0ciA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICBzZW5kZXI6IGdsb2JhbC5VU0VSLAogICAgICAgIHJvb21JZDogZ2xvYmFsLkNIQVRST09NLAogICAgICAgIHJlY2lwaWVudDogZ2xvYmFsLlJFQ0lQSUVOVCwKICAgICAgICB0eXBlOiB0aGlzLnR5cGUsCiAgICAgICAgY29udGVudDogY29udGVudCwKICAgICAgICB0aW1lOiBEYXRlLm5vdygpCiAgICAgIH0pOwogICAgICBnbG9iYWwuQ09OTi5zZW5kKGpzdHIpOwogICAgICB0aGlzLm1zZyA9ICcnOwogICAgfQogIH0KfTs="},{"version":3,"sources":["ChatLog.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div id=\"chat\">\n        <div id=\"log\"></div>\n        <div id=\"form\">\n            <form v-on:submit.prevent=\"sendMsg\" class=\"us-form form-inline\">\n                <select v-model=\"type\" id=\"msg-type\">\n                    <option value='N' selected>一般</option>\n                    <option value='A'>廣播</option>\n                </select>\n                <input v-model=\"msg\" class=\"w3-input w3-border w3-round\" type=\"text\" id=\"msg\" autofocus />\n                <button type=\"submit\">Send</button>\n            </form>\n        </div>\n    </div>\n</template>\n<script>\nimport global from '../gloval_var'\n/* ws */\nwindow.onload = function(){\n  var log = document.getElementById('log')\n\n  // WS連線：接收廣播訊息\n  if (window['WebSocket']) {\n    global.CONN = new WebSocket('ws://' + window.location.host +\"/ws\"+ location.pathname + location.search)\n    global.CONN.onclose = function () {\n      var item = document.createElement('div')\n      item.innerHTML = '<b>Connection closed.</b>'\n      appendLog(item)\n    }\n    global.CONN.onmessage = function (evt) {\n      var messages = evt.data.split('\\n')\n      for (var i = 0; i < messages.length; i++) {\n        HandleMessage(messages[i])\n      }\n    }\n  } else {\n    var item = document.createElement('div')\n    item.innerHTML = '<b>Your browser does not support WebSockets.</b>'\n    appendLog(item)\n  }\n\n\n\n  // 處理訊息\n  function HandleMessage (message) {\n    var item = document.createElement('div')\n    var chat = JSON.parse(message)\n    var chatTime = new Date(chat.time).toLocaleString('zh-TW')\n    // 判斷是否為系統訊息\n    if (chat.sender === 'SYS') {\n      // 系統hint 使用者名單\n      if (chat.type === 'H') {\n        var info = JSON.parse(chat.content)\n        global.ONLINE = [] // 清空原來的在線人員列表\n\n        if (global.CHATROOM !== info.room_info) {\n          alert('聊天室位置出錯!' + global.CHATROOM + info.room_info)\n        }\n\n        // 在線列表\n        var members = info.user_info.split(',')\n        for (let i = 0; i < members.length; i++) {\n          if (members[i] === global.USER) { continue }\n\n          let tmp = { 'username': members[i] }\n          global.ONLINE.push(tmp)\n        }\n      } else {\n        info = JSON.parse(chat.content)\n        var rooms = JSON.parse(info.room_info) // 聊天室名單對應人數\n        var users = info.user_info.split(',') // 聊天室所有在線人員\n\n        /* 上線狀態變更 */\n        for (var member of global.MEMBERS) {\n          if (users.includes(member.username)) {\n            member.online = true\n          } else {\n            member.online = false\n          }\n        }\n\n        /* 聊天室人數變更 */\n        let roomlist_states = (Object.keys(rooms))\n\n        for (global.ROOM of global.ROOMS) {\n          if (roomlist_states.includes(global.ROOM.room_id)) {\n            global.ROOM.len = rooms[global.ROOM.room_id]\n          }\n        }\n      }\n      // 系統訊息ex.ＸＸＸ離開聊天室\n      item.innerHTML = `<div class=\"system-text\"><label>` + info.text + `</label></div>`\n    } else {\n      // 判別內容是否包含鏈結\n      var text = isUrl(chat.content)\n\n      // 來自其他用戶或使用者的廣播消息\n      if (chat.type === 'A') {\n        // 是私訊的話把全域廣播擋下來\n        if (global.PRIVATION === 'true') {\n          return\n        }\n\n        item.innerHTML = `<div class=\"chat-text\">\\\n                  <label class=\"sm-text\"><span class=\"b-text\">` + chat.sender + `</span> - ` + chatTime + ` 廣播</lable><br>\\\n                  <label class=\"bro-text\">` + text + `</label>\\\n              </div>`\n      } else {\n        item.innerHTML = `<div class=\"chat-text\">\\\n                  <label class=\"sm-text\"><span class=\"b-text\">` + chat.sender + `</span> -` + chatTime + `</lable><br>\\\n                  <label class=\"md-text\">` + text + `</label>\\\n              </div>`\n      }\n    }\n    // 打印訊息\n    appendLog(item)\n  }\n\n  //將聊天訊息放入聊天區塊\n  function appendLog(item) {\n    var doScroll = log.scrollTop > log.scrollHeight - log.clientHeight - 1;\n    log.appendChild(item);\n\n    if (doScroll) {\n        log.scrollTop = log.scrollHeight - log.clientHeight;\n    }\n  }\n}\n// 判斷是否為超連結\nfunction isUrl (v) {\n  var reg = /(http:\\/\\/|https:\\/\\/)((\\w|=|\\?|\\.|\\/|&|#|-)+)/g\n  v = v.replace(reg, `<a href='$1$2' target=\"_blank\">$1$2</a>`).replace(/\\n/g, '<br />')\n  return v\n}\nexport default {\n  name: 'ChatLog',\n  data: function () {\n    return {\n      msg: '',\n      type: 'N'\n    }\n  },\n  methods: {\n    sendMsg: function () {\n      var content = this.msg.replaceAll('\\'', '&#39;')\n      if (!global.CONN) {\n        return false\n      }\n      if (this.msg === '') {\n        return false\n      }\n      if (global.PRIVATION === 'true') {\n        this.type = 'P'\n      }\n      var jstr = JSON.stringify({ sender: global.USER, roomId: global.CHATROOM, recipient: global.RECIPIENT, type: this.type, content: content, time: Date.now() })\n      global.CONN.send(jstr)\n      this.msg = ''\n    }\n  },\n}\n\n\n</script>\n"],"sourceRoot":"src/components/chat_componenet"}]}