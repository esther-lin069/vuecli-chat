{"remainingRequest":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/src/components/chat_componenet/Member.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/src/components/chat_componenet/Member.vue","mtime":1606271160817},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/esther_lin/work06/cli/new_chat/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBnbG9iYWwgZnJvbSAnLi4vZ2xvdmFsX3ZhcicKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ01lbWJlcicsCiAgZGF0YTogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcm5hbWU6IGdsb2JhbC5VU0VSLAogICAgICBhX21lbWJlcnM6IGdsb2JhbC5NRU1CRVJTLAogICAgICBvX21lbWJlcnM6IFtdLAogICAgICBzZWVuOiB0cnVlLCAvLyDpoJDoqK3plovllZ/lnKjnt5rliJfooagKICAgICAgc2VhcmNoOiAnJywKICAgICAgYXV0bzogdHJ1ZSwKICAgICAgaW50ZXJ2YWw6IG51bGwsCiAgICAgIENvbG9yczogewogICAgICAgIGFjdGl2ZUNvbG9yOiAnIzQxMzYzNicsCiAgICAgICAgaW5hY3RpdmVDb2xvcjogJyNhY2FjYWMnCiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHByaXZhdGVDaGF0ICh0b1dobykgewogICAgICBsZXQgc29ydF91c2VycyA9IFtnbG9iYWwuVVNFUiwgdG9XaG9dLnNvcnQoKQogICAgICBtYWtlUHJpdmF0ZVJvb20oc29ydF91c2VycywgdG9XaG8pCiAgICB9LAogICAgc2V0QXV0b1JlZnJlc2g6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5hdXRvID0gIXRoaXMuYXV0bwogICAgfSwKICAgIFJlZnJlc2hSZWFkOiBmdW5jdGlvbiAoKSB7CiAgICAgIGdldFJlYWRTdGF0dXMoZ2xvYmFsLlVTRVIpCiAgICB9LAogICAgQXV0b1JlZnJlc2hSZWFkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgdGhpcy5SZWZyZXNoUmVhZCgpCiAgICAgIH0sIDMwMDApCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgLy8g5pCc5bCL5Lim6L+U5Zue57WQ5p6cCiAgICBmaWx0ZXJkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzID0gdGhpcy5zZWFyY2gudG9Mb3dlckNhc2UoKQogICAgICByZXR1cm4gKHMudHJpbSgpICE9PSAnJykKICAgICAgICA/IHRoaXMuYV9tZW1iZXJzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC51c2VybmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YocykgPiAtMSB9KQogICAgICAgIDogdGhpcy5hX21lbWJlcnMKICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy5heGlvcwogICAgICAuZ2V0KGdsb2JhbC5BUEkgKyAnL3VzZXJsaXN0JykKICAgICAgLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICBsZXQgbGlzdCA9IGUuZGF0YS51c2Vycy5zcGxpdCgnLCcpCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gZ2xvYmFsLlVTRVIpIHsgY29udGludWUgfQoKICAgICAgICAgIGxldCB0bXAgPSB7ICdyZWFkJzogJzEnLCAndXNlcm5hbWUnOiBsaXN0W2ldLCAnb25saW5lJzogZmFsc2UgfQogICAgICAgICAgZ2xvYmFsLk1FTUJFUlMucHVzaCh0bXApCiAgICAgICAgfQogICAgICB9KQogIH0sCiAgbW91bnRlZCAoKXsKICAgIHRoaXMub19tZW1iZXJzID0gZ2xvYmFsLk9OTElORQogIH0sCiAgdXBkYXRlZCAoKSB7CiAgICBpZiAodGhpcy5hdXRvID09PSB0cnVlKSB7CiAgICAgIC8vIOavj+malOenkuiHquWLleWIt+aWsOengeioiueLgOaFiwogICAgICB0aGlzLkF1dG9SZWZyZXNoUmVhZCgpCiAgICB9IGVsc2UgewogICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpCiAgICB9CiAgfQp9CgovLyDlu7rnq4vnp4HogYrpgKPntZAKZnVuY3Rpb24gbWFrZVByaXZhdGVSb29tIChzLCB0b1dobykgewogIFZ1ZS5heGlvcyh7CiAgICBtZXRob2Q6ICdwb3N0JywKICAgIGJhc2VVUkw6IGdsb2JhbC5BUEksCiAgICB1cmw6ICcvcHJpdmF0ZXJvb20nLAogICAgZGF0YTogewogICAgICAndXNlcic6IGdsb2JhbC5VU0VSLAogICAgICAncm9vbU5hbWUnOiBzWzBdICsgJy0nICsgc1sxXSwKICAgICAgJ3dpdGgnOiB0b1dobwogICAgfQogIH0pLnRoZW4oKHJlcykgPT4gewogICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXMucmVxdWVzdC5yZXNwb25zZVVSTAogIH0pCn0KCi8vIOaLv+WPluengeioiuW3suiugOiIh+WQpueahOizh+aWmQpmdW5jdGlvbiBnZXRSZWFkU3RhdHVzICh1c2VyKSB7CiAgbGV0IG1lbWJlcgogIFZ1ZS5heGlvcyh7CiAgICBtZXRob2Q6ICdnZXQnLAogICAgdXJsOiBnbG9iYWwuQVBJICsgJy9yZWFkc3RhdHVzLycgKyB1c2VyCiAgfSkudGhlbigoZSkgPT4gewogICAgdmFyIG9iaiA9IEpTT04ucGFyc2UoZS5kYXRhLnJlYWRzdGF0dXMpCiAgICAvLyDmjqXmlLbliLDmnKroroDmqJnoqJjvvIzmm7TmlLnlkI3llq7lhaflrrkKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgZm9yIChtZW1iZXIgb2YgZ2xvYmFsLk1FTUJFUlMpIHsKICAgICAgaWYgKE9iamVjdC5rZXlzKG9iaikuaW5jbHVkZXMobWVtYmVyLnVzZXJuYW1lKSkgewogICAgICAgIGlmIChvYmpbbWVtYmVyLnVzZXJuYW1lXSA9PT0gJzAnKSB7IG1lbWJlci5yZWFkID0gJzAnIH0KICAgICAgfQogICAgfQogIH0pCn0K"},{"version":3,"sources":["Member.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Member.vue","sourceRoot":"src/components/chat_componenet","sourcesContent":["<template>\n  <div>\n    <div id=\"member\">\n      <h5 class=\"title-text\">\n        <button\n          class=\"list-btn\"\n          @click=\"seen = !seen\"\n          :style=\"{ color: seen ? Colors.activeColor : Colors.inactiveColor }\"\n        >\n          在線列表\n        </button>\n        <span> |</span>\n        <button\n          class=\"list-btn\"\n          @click=\"seen = !seen\"\n          :style=\"{ color: !seen ? Colors.activeColor : Colors.inactiveColor }\"\n        >\n          所有使用者\n        </button>\n      </h5>\n\n      <div id=\"myUserBlock\" class=\"card\">\n        <div class=\"div-ell\">\n          <span style=\"color: #f4e868; margin-right: 8px\">\n            <i class=\"fa fa-user\"></i>\n          </span>\n          <span class=\"box-text\">{{ username }}</span>\n        </div>\n      </div>\n\n      <transition name=\"slide-fade\" mode=\"out-in\">\n        <!-- 線上使用者區塊 -->\n        <div v-if=\"seen\" key=\"online\">\n          <!-- 清單 -->\n          <dl>\n            <dt\n              v-for=\"(member, index) in o_members\"\n              :id=\"member.username\"\n              :key=\"index\"\n            >\n              <div class=\"card\">\n                <div class=\"div-ell\">\n                  <span style=\"color: #00798f; margin-right: 8px\">\n                    <i class=\"fa fa-user\"></i>\n                  </span>\n                  <span class=\"box-text\">{{ member.username }}</span>\n                </div>\n              </div>\n            </dt>\n          </dl>\n        </div>\n\n        <!-- 所有使用者區塊 -->\n        <div v-else class=\"all-users\" key=\"all\">\n          <label style=\"margin-left: 10%\">搜尋</label>\n          <input\n            v-model=\"search\"\n            type=\"text\"\n            class=\"user-search w3-input w3-border w3-round\"\n          />\n          <button @click=\"RefreshRead\" class=\"status-h\">刷新</button>\n          <a class=\"status-a\" @click=\"setAutoRefresh\"\n            >自動更新：{{ auto == true ? \"on\" : \"off\" }}</a\n          >\n\n          <!-- 清單 -->\n          <dl style=\"margin-top: 2.5em\">\n            <dt\n              v-for=\"(member, index) in filterd\"\n              :id=\"member.username\"\n              :key=\"index\"\n            >\n              <div class=\"card\" :title=\"member.username\">\n                <div class=\"div-ell\">\n                  <span\n                    :class=\"\n                      member.online != true ? 'user-fa-on' : 'user-fa-off'\n                    \"\n                  >\n                    <i class=\"fa fa-user\"></i>\n                  </span>\n                  <a\n                    title=\"私聊\"\n                    @click=\"privateChat(member.username)\"\n                    :class=\"member.read == '0' ? 'pchat-btn-r' : 'pchat-btn-w'\"\n                    role=\"button\"\n                  >\n                    <i class=\"fa fa-comment-dots\"></i>\n                  </a>\n                  <span class=\"box-text\">{{ member.username }}</span>\n                </div>\n              </div>\n            </dt>\n          </dl>\n        </div>\n      </transition>\n    </div>\n  </div>\n</template>\n\n<script>\nimport global from '../gloval_var'\nimport Vue from 'vue'\n\nexport default {\n  name: 'Member',\n  data: function () {\n    return {\n      username: global.USER,\n      a_members: global.MEMBERS,\n      o_members: [],\n      seen: true, // 預設開啟在線列表\n      search: '',\n      auto: true,\n      interval: null,\n      Colors: {\n        activeColor: '#413636',\n        inactiveColor: '#acacac'\n      }\n    }\n  },\n  methods: {\n    privateChat (toWho) {\n      let sort_users = [global.USER, toWho].sort()\n      makePrivateRoom(sort_users, toWho)\n    },\n    setAutoRefresh: function () {\n      this.auto = !this.auto\n    },\n    RefreshRead: function () {\n      getReadStatus(global.USER)\n    },\n    AutoRefreshRead: function () {\n      this.interval = setInterval(() => {\n        this.RefreshRead()\n      }, 3000)\n    }\n  },\n  computed: {\n    // 搜尋並返回結果\n    filterd: function () {\n      var s = this.search.toLowerCase()\n      return (s.trim() !== '')\n        ? this.a_members.filter(function (d) { return d.username.toLowerCase().indexOf(s) > -1 })\n        : this.a_members\n    }\n  },\n  created () {\n    this.axios\n      .get(global.API + '/userlist')\n      .then(function (e) {\n        let list = e.data.users.split(',')\n        for (let i = 0; i < list.length; i++) {\n          if (list[i] === global.USER) { continue }\n\n          let tmp = { 'read': '1', 'username': list[i], 'online': false }\n          global.MEMBERS.push(tmp)\n        }\n      })\n  },\n  mounted (){\n    this.o_members = global.ONLINE\n  },\n  updated () {\n    if (this.auto === true) {\n      // 每隔秒自動刷新私訊狀態\n      this.AutoRefreshRead()\n    } else {\n      clearInterval(this.interval)\n    }\n  }\n}\n\n// 建立私聊連結\nfunction makePrivateRoom (s, toWho) {\n  Vue.axios({\n    method: 'post',\n    baseURL: global.API,\n    url: '/privateroom',\n    data: {\n      'user': global.USER,\n      'roomName': s[0] + '-' + s[1],\n      'with': toWho\n    }\n  }).then((res) => {\n    window.location.href = res.request.responseURL\n  })\n}\n\n// 拿取私訊已讀與否的資料\nfunction getReadStatus (user) {\n  let member\n  Vue.axios({\n    method: 'get',\n    url: global.API + '/readstatus/' + user\n  }).then((e) => {\n    var obj = JSON.parse(e.data.readstatus)\n    // 接收到未讀標記，更改名單內容\n    // eslint-disable-next-line no-undef\n    for (member of global.MEMBERS) {\n      if (Object.keys(obj).includes(member.username)) {\n        if (obj[member.username] === '0') { member.read = '0' }\n      }\n    }\n  })\n}\n</script>\n"]}]}